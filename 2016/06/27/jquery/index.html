<!DOCTYPE HTML>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>jquery源码分析 | chenjiefly的博客</title>
  <meta name="author" content="chenjiefly">
  
  <meta name="description" content="jquery源码分析和使用技巧等">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="jquery源码分析"/>
  <meta property="og:site_name" content="chenjiefly的博客"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="chenjiefly的博客" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

  
<script type="text/javascript">
    var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "//hm.baidu.com/hm.js?b7eade04c61852edaa0158418c6da079";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>


<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">chenjiefly的博客</a></h1>
  <span class="dash">——</span>
  <h2><a href="/">怠慢不能励精，险躁不能冶性</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">主页</a></li>
    
      <li><a href="https://github.com/chenjiefly">Github</a></li>
    
      <li><a href="/archives">归档</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      
        <img src="">
      
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-06-27T08:01:03.000Z"><a href="/2016/06/27/jquery/">2016-06-27</a></time>
      
      
  
    <h1 class="title">jquery源码分析</h1>
  

    </header>
    <div class="entry">
      
        <div id="toc" class="toc-article">
    <div class="toc-title">本文目录</div>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#jquery源码分析"><span class="toc-text">jquery源码分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#jquery源码地址"><span class="toc-text">jquery源码地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#整体框架提炼"><span class="toc-text">整体框架提炼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jquery源码注释中的-hash"><span class="toc-text">jquery源码注释中的#hash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用闭包传递window的原因"><span class="toc-text">使用闭包传递window的原因</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21-94-定义的一些变量和方法，jQuery-function"><span class="toc-text">(21, 94) 定义的一些变量和方法，jQuery = function() {}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#96-283-给jQuery对象，添加一些方法和属性"><span class="toc-text">(96, 283) 给jQuery对象，添加一些方法和属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#285-347-extend-jQuery的继承方法"><span class="toc-text">(285, 347) extend : jQuery的继承方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#349-817-jQuery-extend-扩展一些工具方法"><span class="toc-text">(349, 817) jQuery.extend() : 扩展一些工具方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#877-2856-Sizzle-复杂选择器的实现，是独立模块，如果其他应用开发中需要用到选择器，可单独下载这个模块"><span class="toc-text">( 877, 2856) Sizzle : 复杂选择器的实现，是独立模块，如果其他应用开发中需要用到选择器，可单独下载这个模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2880-3042-Callbacks-回调对象，对函数的统一管理"><span class="toc-text">(2880, 3042) Callbacks : 回调对象，对函数的统一管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3043-3183-Deferred-延迟对象，对异步操作的统一管理"><span class="toc-text">(3043, 3183) Deferred : 延迟对象，对异步操作的统一管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3184-3295-Support-功能检测，如判断新老版本浏览器"><span class="toc-text">(3184, 3295) Support : 功能检测，如判断新老版本浏览器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3308-3652-data-data方法实现，数据缓存"><span class="toc-text">(3308, 3652) data() : data方法实现，数据缓存</span></a></li></ol></li></ol>
</div>
      
        <ul>
<li>jquery源码分析</li>
<li>jquery使用技巧</li>
</ul>
<img src="/2016/06/27/jquery/logo.jpg" alt="图片来源：bing" title="图片来源：bing">
<a id="more"></a>
<h2 id="jquery源码分析"><a href="#jquery源码分析" class="headerlink" title="jquery源码分析"></a>jquery源码分析</h2><h3 id="jquery源码地址"><a href="#jquery源码地址" class="headerlink" title="jquery源码地址"></a>jquery源码地址</h3><p><a href="https://code.jquery.com/jquery-2.0.3.js" target="_blank" rel="external">CDN上的源码</a><br><a href="/2016/06/27/jquery/jquery-2.0.3.JS" title="带注释笔记的jquery源码">带注释笔记的jquery源码</a></p>
<hr>
<h3 id="整体框架提炼"><a href="#整体框架提炼" class="headerlink" title="整体框架提炼"></a>整体框架提炼</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"> window, undefined </span>) </span>&#123;</span><br><span class="line">    (  <span class="number">21</span>,   <span class="number">94</span>) 定义了一些变量和方法，jQuery = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">    (  <span class="number">96</span>,  <span class="number">283</span>) 给jQuery对象添加一些方法和属性</span><br><span class="line">    ( <span class="number">285</span>,  <span class="number">347</span>) extend : jQuery的继承方法</span><br><span class="line">    ( <span class="number">349</span>,  <span class="number">817</span>) jQuery.extend() : 扩展一些工具方法</span><br><span class="line">    ( <span class="number">877</span>, <span class="number">2856</span>) Sizzle : 复杂选择器的实现，是独立模块，如果其他应用开发中需要用到选择器，可单独下载这个模块</span><br><span class="line">    (<span class="number">2880</span>, <span class="number">3042</span>) Callbacks : 回调对象，对函数的统一管理</span><br><span class="line">    (<span class="number">3043</span>, <span class="number">3183</span>) Deferred : 延迟对象，对异步操作的统一管理</span><br><span class="line">    (<span class="number">3184</span>, <span class="number">3295</span>) Support : 功能检测，如判断新老版本浏览器</span><br><span class="line">    (<span class="number">3308</span>, <span class="number">3652</span>) data() : data方法实现，数据缓存</span><br><span class="line">    (<span class="number">3653</span>, <span class="number">3797</span>) queue() : 队列管理，如多步骤动画，每一步都要先入队，执行一步出对一步</span><br><span class="line">    (<span class="number">3803</span>, <span class="number">4299</span>) attr() prop() val() addClass()等 : 对元素属性操作的相关方法</span><br><span class="line">    (<span class="number">4300</span>, <span class="number">5128</span>) on() trigger() : 对事件操作的相关方法</span><br><span class="line">    (<span class="number">5140</span>, <span class="number">6057</span>) DOM操作的相关方法 : 添加、删除、获取、包装、筛选和插入等</span><br><span class="line">    (<span class="number">6058</span>, <span class="number">6620</span>) css() : 对样式的操作，会考虑兼容性、属性值运算和容错等相关处理</span><br><span class="line">    (<span class="number">6621</span>, <span class="number">7854</span>) 提交数据和ajax : ajax() load() getJson()等</span><br><span class="line">    (<span class="number">7855</span>, <span class="number">8584</span>) 动画相关方法 : animate() show() hide() fadeIn() fadeOut()等</span><br><span class="line">    (<span class="number">8585</span>, <span class="number">8792</span>) 位置与尺寸相关方法：offset() scrollTop</span><br><span class="line">    (<span class="number">8804</span>, <span class="number">8821</span>) jQuery支持模块化的模式</span><br><span class="line">    (<span class="number">8825</span>, <span class="number">8827</span>) 接口暴露 : <span class="built_in">window</span>.jQuery = <span class="built_in">window</span>.$ = jQuery</span><br><span class="line">&#125;)( <span class="built_in">window</span> )</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="jquery源码注释中的-hash"><a href="#jquery源码注释中的-hash" class="headerlink" title="jquery源码注释中的#hash"></a>jquery源码注释中的<code>#hash</code></h3><ul>
<li>jquery源码注释中有很多hash值，可以用来在线查询bug的更详细信息</li>
<li>以下网址可以搜索相关信息<ul>
<li><a href="https://bugs.jquery.com/report" target="_blank" rel="external">https://bugs.jquery.com/report</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="使用闭包传递window的原因"><a href="#使用闭包传递window的原因" class="headerlink" title="使用闭包传递window的原因"></a>使用闭包传递<code>window</code>的原因</h3><ul>
<li>闭包内的变量是局部的，利于和外部模块隔离</li>
<li>将<code>window</code>对象作为参数传入闭包<ul>
<li>引用速度快</li>
<li>压缩版本中，只需要形参为<code>window</code>，闭包内的<code>window</code>可以全部压缩为单字母<code>e</code></li>
</ul>
</li>
<li>传入<code>undefined</code>原因<ul>
<li><code>undefined</code>是可以被修改的，如<code>undefined = 10</code></li>
<li>之所以这样传入<code>undefined</code>是为了防止<code>undefined</code>在外部被修改</li>
</ul>
</li>
</ul>
<hr>
<h3 id="21-94-定义的一些变量和方法，jQuery-function"><a href="#21-94-定义的一些变量和方法，jQuery-function" class="headerlink" title="(21, 94) 定义的一些变量和方法，jQuery = function() {}"></a>(21, 94) 定义的一些变量和方法，jQuery = function() {}</h3><p>1、rootjQuery</p>
<ul>
<li>document对象的jquery对象，赋值后的变量便于代码压缩</li>
<li><code>rootjQuery = jQuery(document);</code></li>
</ul>
<p>2、core_strundefined = typeof undefined</p>
<ul>
<li>将<code>undefined</code>转换为字符串类型，便于后续的变量比较</li>
<li>之所以用字符串是因为兼容性问题，如IE6-IE9时，xmlNode节点的方法可能无法判断是否为<code>undefined</code></li>
<li>而字符串的<code>undefined</code>是全部兼容的</li>
</ul>
<p>3、<code>_jQuery</code>和<code>_$</code></p>
<ul>
<li>防冲突使用的两个变量</li>
<li>如果<code>jquery</code>外面的代码已经占用了<code>window</code>下的<code>jQuery</code>和<code>$</code>，则在这两个变量里缓存，以防止冲突</li>
</ul>
<p>4、<code>class2type = {}</code></p>
<ul>
<li><code>$.type()</code>方法中判断每个元素的类型</li>
<li>生成后的参考内容<code>class2type = { &#39;[Object String]&#39;: &#39;string&#39;, &#39;[Object Array&#39;: &#39;array&#39;}</code></li>
</ul>
<p>5、<strong>jQuery对象定义</strong></p>
<ul>
<li>源码提炼</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 源码61行 */</span></span><br><span class="line"><span class="comment">// Define a local copy of jQuery</span></span><br><span class="line">jQuery = <span class="function"><span class="keyword">function</span>(<span class="params"> selector, context </span>) </span>&#123;</span><br><span class="line">    <span class="comment">// The jQuery object is actually just the init constructor 'enhanced'</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> jQuery.fn.init( selector, context, rootjQuery );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 源码96行 */</span></span><br><span class="line">jQuery.fn = jQuery.prototype = &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 源码283行 */</span></span><br><span class="line"><span class="comment">// Give the init function the jQuery prototype for later instantiation</span></span><br><span class="line">jQuery.fn.init.prototype = jQuery.fn;</span><br></pre></td></tr></table></figure>
<ul>
<li>这样定义是为了链式操作<code>jQuery().css()</code>，每一个方法都需要返回一个<code>jquery</code>对象</li>
<li>如果使用下面代码实现类似功能，则会导致内存泄露，最终浏览器崩溃</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 很明显递归调用了，无限地new肯定会导致内存爆掉</span><br><span class="line">jQuery = function( selector, context ) &#123;</span><br><span class="line">    return new jQuery( selector, context, rootjQuery );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>jQuery</code>和<code>jQuery.fn.init</code>这两个方法的地址是不同的，但是原型是相同的</li>
<li>之所以jQuery方法返回的对象拥有所有的jQuery方法，就是因为原型对象的传递赋值<ul>
<li>上面后两段代码合并结果就是<code>jQuery.fn.init.prototype = jQuery.prototype</code></li>
<li>所以<code>jQuery.fn.init</code>返回的对象和<code>jQuery</code>拥有相同的方法</li>
</ul>
</li>
</ul>
<hr>
<h3 id="96-283-给jQuery对象，添加一些方法和属性"><a href="#96-283-给jQuery对象，添加一些方法和属性" class="headerlink" title="(96, 283) 给jQuery对象，添加一些方法和属性"></a>(96, 283) 给jQuery对象，添加一些方法和属性</h3><p>1、对象和方法的简化</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">jQuery.fn = jQuery.prototype = &#123;</span><br><span class="line">    jquery: 版本号</span><br><span class="line">    <span class="keyword">constructor</span>: 修正构造器的指向问题，因为jQuery.prototype = &#123;...&#125;被对象给覆盖了，构造器就被修改为<span class="built_in">Object</span>了</span><br><span class="line">    init(): 初始化和参数管理</span><br><span class="line">    selector: 存储选择字符串</span><br><span class="line">    length: <span class="keyword">this</span>对象的长度</span><br><span class="line">    toArray(): 类数组对象转换为数组，$(<span class="string">'div'</span>): &#123;<span class="number">0</span>: div, <span class="number">1</span>: div, <span class="number">2</span>: div, length: <span class="number">3</span>&#125; =&gt; [div, div, div]</span><br><span class="line">    get(): 转换为原生元素集合，写下标得到下标对应的原生元素，不写下标参数则返回所有原生元素的集合</span><br><span class="line">    pushStack(): jQuery对象入栈，$(<span class="string">'div'</span>).pushStack($(<span class="string">'span'</span>)).css()，实际是对span设置样式</span><br><span class="line">    each(): 集合遍历</span><br><span class="line">    ready(): DOM加载成功后执行方法fn，fn为入参方法，jQuery.ready.promise().done( fn );</span><br><span class="line">    slice(): 截取jquery对象集合中的元素，类似数组的slice</span><br><span class="line">    first(): 获取jquery对象集合中的第一个元素</span><br><span class="line">    last():获取jquery对象集合中的最后一个元素</span><br><span class="line">    eq(): 获取jquery对象集合中的第n个元素，n为方法入参</span><br><span class="line">    map(): 遍历集合</span><br><span class="line">    end(): 返回pushStack栈中的前一个元素</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 数组的三个方法，源码内部使用</span></span><br><span class="line">    push(): 数组元素入栈</span><br><span class="line">    sort(): 数组排序</span><br><span class="line">    splice(): 数组截取、删除和添加方法</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="285-347-extend-jQuery的继承方法"><a href="#285-347-extend-jQuery的继承方法" class="headerlink" title="(285, 347) extend : jQuery的继承方法"></a>(285, 347) extend : jQuery的继承方法</h3><p>1、扩展功能的方法extend实现</p>
<ul>
<li><p>jQuery.extend = jQuery.fn.extend = function() {}</p>
<ul>
<li>工具和插件扩展方法extend的具体实现</li>
<li>使用jQuery.extend扩展的是工具方法</li>
<li>使用jQuery.fn.extend扩展的是对象插件</li>
</ul>
</li>
<li><p>当写一个对象字面量时，实际是扩展工具或对象插件</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 扩展jquery插件工具方法，调用方法为：$.aaa()和$.bbb()</span><br><span class="line">// $.extend();  -&gt;  this  -&gt; $  -&gt; this.aaa  -&gt; $.aaa()</span><br><span class="line">$.extend(&#123;</span><br><span class="line">    aaa: function() &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;,</span><br><span class="line">    bbb: function() &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 扩展jquery对象实例方法，调用方法为：$().aaa()和$().bbb()</span><br><span class="line">// $.fn.extend();  -&gt;  this  -&gt; $.fn  -&gt;  $.prototype  -&gt; this.aaa  -&gt; $().aaa()</span><br><span class="line">$.fn.extend(&#123;</span><br><span class="line">    aaa: function() &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;,</span><br><span class="line">    bbb: function() &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>当写多个对象字面量时，实际是对象拷贝操作，后面的对象全都扩展到第一个对象上</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var a = &#123;&#125;;</span><br><span class="line">$.extend(&#123;&#125;, &#123;name: &apos;hello&apos;&#125;, &#123;age: &apos;20&apos;&#125;);</span><br></pre></td></tr></table></figure>
<p>2、浅拷贝和深拷贝</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 默认浅拷贝</span><br><span class="line">$.extend(&#123;&#125;, &#123;name: &apos;hello&apos;&#125;, &#123;age: &apos;20&apos;&#125;);</span><br><span class="line"></span><br><span class="line">// 深拷贝</span><br><span class="line">$.extend(true, &#123;&#125;, &#123;name: &apos;hello&apos;&#125;, &#123;age: &apos;20&apos;&#125;);</span><br></pre></td></tr></table></figure>
<p>3、继承的方式</p>
<ul>
<li>jQuery中的拷贝继承<ul>
<li>将目标对象中没有的属性从源对象中拷贝到目标对象上</li>
</ul>
</li>
<li>JS中的类式继承<ul>
<li>针对的是new 构造函数</li>
</ul>
</li>
<li>JS中的原型继承<ul>
<li>利用prototype来继承</li>
</ul>
</li>
</ul>
<hr>
<h3 id="349-817-jQuery-extend-扩展一些工具方法"><a href="#349-817-jQuery-extend-扩展一些工具方法" class="headerlink" title="(349, 817) jQuery.extend() : 扩展一些工具方法"></a>(349, 817) jQuery.extend() : 扩展一些工具方法</h3><p>1、expando</p>
<ul>
<li>每一个jquery对象在页面中的唯一标识</li>
<li>主要作用是作为映射关系的键</li>
</ul>
<p>2、noConflict()</p>
<ul>
<li>防冲突方法，防止加载jquery.js库前，$和jQuery就已经被占用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var jq = $.noConflict();  // 放弃$</span><br><span class="line">var JQ = $.noConflict(true);  // 放弃jQuery</span><br></pre></td></tr></table></figure>
<p>3、isReady</p>
<ul>
<li><p>window.onload = function() {}</p>
<ul>
<li>需要等DOM和资源文件都加载完成才执行JS</li>
<li>如<code>&lt;img src=&quot;&quot;/&gt;</code></li>
</ul>
</li>
<li><p>$(function() {})</p>
<ul>
<li>只要DOM加载完就执行JS</li>
<li>不需要等图片加载完成，速度比window.onload快</li>
<li><code>$(function() {})  =&gt;  $(document).ready()  =&gt;  $().ready()  =&gt; $.fn.ready()  =&gt; jQuery.ready.promise().done( fn )  =&gt;  $.ready()</code></li>
</ul>
</li>
</ul>
<p>4、readyWait</p>
<ul>
<li>推迟DOM ready的变量锁</li>
<li>可能会为了等很多文件，所以该变量锁是一个计数器</li>
</ul>
<p>5、holdReady()</p>
<ul>
<li><p>DOM 推迟 ready</p>
</li>
<li><p>写法</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$.holdReady(true)   // 推迟一次，jQuery.readyWait++</span><br><span class="line">$.holdReady(false)  // 释放推迟一次，--jQuery.readyWait</span><br></pre></td></tr></table></figure>
<ul>
<li>作用：异步加载文件要先执行，然后才执行DOM加载完成后的方法</li>
</ul>
<p>6、ready()</p>
<ul>
<li>DOM ready的三种写法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(function() &#123;&#125;);</span><br><span class="line">$(document).ready(function() &#123;&#125;);</span><br><span class="line">$(document).on(&apos;ready&apos;, function() &#123;&#125;);</span><br></pre></td></tr></table></figure>
<p>7、简单工具方法</p>
<ul>
<li>isFunction()：判断是否为函数<ul>
<li>低版本IE浏览器下，alert等原生函数返回的结果是<code>Object</code>，可参考bug#2968</li>
</ul>
</li>
<li>isArray()：判断是否为数组<ul>
<li>jquery@2.0.3不支持IE6、7、8，所以该方法直接用原生的，速度快</li>
</ul>
</li>
<li>isWindow()：判断是否为window对象<ul>
<li>obj != null 的作用是为了防止假值之间的判断，因为undefined == null为真</li>
<li>obj === obj.window 的判断实现，因为只有window对象下才会有window</li>
</ul>
</li>
<li>isNumeric()：判断是否为数字</li>
<li>isPlainObject()： 判断是否为对象字面量<ul>
<li>DOM节点和<code>window</code>排除在对象字面量外</li>
<li>系统自带的对象，如<code>window.location</code>要排除在外，利用只有对象字面量的<code>constructor.prototype</code>才会有<code>isPrototypeOf</code>真这个原理</li>
</ul>
</li>
<li>isEmptyObject(): 空对象判断</li>
<li>error(): 抛出异常</li>
<li>parseJSON(): JSON.parse()</li>
<li>each(): 遍历集合，数组、对象、类数组对象</li>
<li>trim(): 去除字符串前后空格</li>
<li>inArray(): 判断入参元素是否存在于数组中，数组版的indexOf</li>
<li>map(): 映射新数组</li>
<li>now(): 获取当前时间，即Date.now()方法</li>
</ul>
<p>8、parseHTML()</p>
<ul>
<li>keepScripts<ul>
<li>作用是如果HTML片段中有script标签，那么如果该值为true，则script标签中的代码会被执行</li>
</ul>
</li>
<li>单标签<code>&lt;li&gt;&lt;/li&gt;</code><ul>
<li>使用<code>context.createElement( parsed[1] )</code>生成节点</li>
</ul>
</li>
<li>多标签   <code>&lt;li&gt;&lt;/li&gt;&lt;script&gt;&lt;/script&gt;</code><ul>
<li>使用<code>jQuery.buildFragment( [ data ], context, scripts )</code> </li>
</ul>
</li>
</ul>
<p>9、parseXML()</p>
<ul>
<li>解析XML格式数据</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var tmp = new DOMParser(),  // IE8以下不支持</span><br><span class="line">    xml = tmp.parseFromString( data , &quot;text/xml&quot; );  // data是XML对象字串</span><br></pre></td></tr></table></figure>
<p>10、noop()</p>
<ul>
<li>空函数，做插件和组件开发时可作为默认参数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function aaa() &#123;</span><br><span class="line">    this.default = &#123;</span><br><span class="line">        show: function() &#123;&#125;  // 可用$.noop代替</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>11、globalEval()</p>
<ul>
<li>全局解析JS，严格模式下采用创建<code>&lt;script&gt;</code>标签插入页面中的方法实现，一般模式下直接使用<code>eval</code>解析</li>
<li><code>eval</code>和<code>window.eval</code>的区别<ul>
<li><code>eval</code>是关键字，声明的变量局部有效，并不能为全局变量</li>
<li><code>window.eval</code>是方法，可以解析为全局变量</li>
</ul>
</li>
</ul>
<p>12、camelCase()</p>
<ul>
<li>转驼峰方法（内部使用），如margin-top转换为marginTop</li>
<li>注意<code>-ms-opacity</code>会先转为<code>ms-opacity</code>，再转换为<code>MsOpacity</code></li>
</ul>
<p>13、nodeName()</p>
<ul>
<li>是否为指定节点名（内部使用）</li>
<li>名字对比时，需要转换为小写，因为在不同浏览器下节点名称可能大小写不统一</li>
</ul>
<p>14、makeArray()</p>
<ul>
<li>类数组转换为真数组（有第二个参数result，那就是内部使用的）</li>
<li>字符串、数字等都可以转成数组</li>
</ul>
<p>15、merge()</p>
<ul>
<li>合并数组</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$.merge([&apos;a&apos;, &apos;b&apos;], [&apos;c&apos;, &apos;d&apos;])</span><br></pre></td></tr></table></figure>
<ul>
<li>合并特殊json对象</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$.merge([&apos;a&apos;, &apos;b&apos;], &#123;0: &apos;c&apos;, 1: &apos;d&apos;, length&#125;)</span><br><span class="line">$.merge(&#123;0: &apos;c&apos;, 1: &apos;d&apos;, length: 2&#125;, [&apos;a&apos;, &apos;b&apos;])</span><br><span class="line">$.merge(&#123;0: &apos;a&apos;, 1: &apos;b&apos;, length: 2&#125;, &#123;0: &apos;c&apos;, 1: &apos;d&apos;, length&#125;)</span><br></pre></td></tr></table></figure>
<p>16、grep()</p>
<ul>
<li>过滤新数组</li>
<li><code>grep: function( elems, callback, inv ){...}</code><ul>
<li>elems为数组</li>
<li>callback为过滤方法，返回true或false</li>
<li>inv决定返回callback返回的值为真或假时对应的元素，相当于集合取反</li>
</ul>
</li>
</ul>
<p>17、guid</p>
<ul>
<li>jquery内部的唯一标识符，可以累加</li>
<li>与事件操作有关系，将事件操作和回调方法关联起来</li>
</ul>
<p>18、proxy()</p>
<ul>
<li>jquery中改变方法内部this指向的方法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">function show(x, y) &#123;</span><br><span class="line">    console.log(x);</span><br><span class="line">    console.log(y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 返回的是一个方法，还不能执行</span><br><span class="line">$.proxy(fn, context)</span><br><span class="line"></span><br><span class="line">// 这样就能执行了</span><br><span class="line">$.proxy(fn, context)()</span><br><span class="line"></span><br><span class="line">// 传参数</span><br><span class="line">$.proxy(fn, context, x0, y0)()  // 不触发方法时的传参</span><br><span class="line">$.proxy(fn, context)(x0, y0)    // 直接执行方法时的传参</span><br><span class="line"></span><br><span class="line">// 简化写法，改变对象内方法中的this指向</span><br><span class="line">var obj = &#123;</span><br><span class="line">    show: function() &#123;</span><br><span class="line">        console.log(this);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$(document).click($.proxy(obj.show, obj));  // 普通写法</span><br><span class="line">$(document).click($.proxy(obj, &apos;show&apos;));    // 简化写法</span><br></pre></td></tr></table></figure>
<p>19、access()</p>
<ul>
<li>多功能值操作（内部使用）</li>
<li>用于适应$().css()、$().attr()等get/set方法的公用方法</li>
<li>参数<ul>
<li>elems : 元素集合</li>
<li>fn : 回调函数，用于css()、attr()这些方法的个性化处理</li>
<li>key : css()、attr()设置参数对象的key</li>
<li>value : key对应的值</li>
<li>chainable : 决定设置（true）还是获取（false）操作</li>
<li>emptyGet : 获取操作情况下，当匹配到的集合为空时，获取的值</li>
<li>raw : 传入的value是否为方法，true表示不是方法是对象</li>
</ul>
</li>
</ul>
<p>20、swap()</p>
<ul>
<li>交换元素的style属性</li>
<li>场景<ul>
<li><code>$().width()</code>可以获取到设置了<code>display:none;</code>的元素的宽度</li>
<li><code>$().get(0).offsetWidth</code>获取不到设置为<code>display:none;</code>的元素的宽度</li>
<li>jquery实现<code>width()</code>方法功能就是利用了<code>swap()</code>方法</li>
</ul>
</li>
<li>原理<ul>
<li>先保存原来的<code>display:none;</code>存起来</li>
<li>然后设置元素样式为<code>display:block;visibility: hidden;position: absolute;</code></li>
<li>于是就可以使用<code>$().get(0).offsetWidth</code>获取宽度</li>
<li>最后将设置的样式恢复为原来保存的即可</li>
</ul>
</li>
</ul>
<hr>
<h3 id="877-2856-Sizzle-复杂选择器的实现，是独立模块，如果其他应用开发中需要用到选择器，可单独下载这个模块"><a href="#877-2856-Sizzle-复杂选择器的实现，是独立模块，如果其他应用开发中需要用到选择器，可单独下载这个模块" class="headerlink" title="( 877, 2856) Sizzle : 复杂选择器的实现，是独立模块，如果其他应用开发中需要用到选择器，可单独下载这个模块"></a>( 877, 2856) Sizzle : 复杂选择器的实现，是独立模块，如果其他应用开发中需要用到选择器，可单独下载这个模块</h3><hr>
<h3 id="2880-3042-Callbacks-回调对象，对函数的统一管理"><a href="#2880-3042-Callbacks-回调对象，对函数的统一管理" class="headerlink" title="(2880, 3042) Callbacks : 回调对象，对函数的统一管理"></a>(2880, 3042) Callbacks : 回调对象，对函数的统一管理</h3><p>1、功能</p>
<ul>
<li>用于管理一系列的回调函数列表，在内部使用时为<code>$.ajax()</code>和<code>$.Deferred()</code>提供基本功能模块</li>
<li>用于可以实现统一触发一批不同作用域下的函数</li>
</ul>
<p>2、方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var cb = $.Callbacks();</span><br><span class="line"></span><br><span class="line">cb.add(fn1);     // 相当于绑定事件</span><br><span class="line">cb.add(fn2);</span><br><span class="line">cb.fire();       // 相当于触发事件，一旦触发连续执行fn1和fn2</span><br><span class="line">cb.remove(fn1);  // 相当于移除事件</span><br></pre></td></tr></table></figure>
<p>3、 <code>$.Callbacks(options)</code>方法入参</p>
<ul>
<li>once<ul>
<li>确保添加的方法只能被执行一次，<code>$.Callbacks(&#39;once&#39;)</code></li>
</ul>
</li>
<li>memory<ul>
<li>记忆功能，<code>fire()</code>方法将会触发位于该方法前后的通过<code>add()</code>添加的方法</li>
<li>实际实现的方法其实就是允许在memory存在的情况下，<code>add()</code>中也允许调用<code>fire()</code></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var cb = $.Callbacks(&apos;memory&apos;);</span><br><span class="line"></span><br><span class="line">cb.add(fn1);  // fn1和fn2都会被调用执行</span><br><span class="line">cb.fire();</span><br><span class="line">cb.add(fn2);</span><br></pre></td></tr></table></figure>
<ul>
<li>unique<ul>
<li>确保一个方法只能被添加一次</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var cb = $.Callbacks(&apos;unique&apos;);</span><br><span class="line"></span><br><span class="line">cb.add(fn);  // fn值会被调用执行一次</span><br><span class="line">cb.add(fn);</span><br><span class="line">cb.fire();</span><br></pre></td></tr></table></figure>
<ul>
<li>stopOnFalse<ul>
<li>当callback方法返回false时，中断后续callback的调用</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var cb = $.Callbacks(&apos;stopOnFalse&apos;);</span><br><span class="line"></span><br><span class="line">function aaa() &#123;return 1;&#125;</span><br><span class="line">function bbb() &#123;return false;&#125;</span><br><span class="line">function ccc() &#123;return 1;&#125;</span><br><span class="line"></span><br><span class="line">cb.add(aaa);  // ccc()不会被调用，因为bbb()返回了false</span><br><span class="line">cb.add(bbb);</span><br><span class="line">cb.add(ccc);</span><br><span class="line">cb.fire();</span><br></pre></td></tr></table></figure>
<p>4、组合参数</p>
<ul>
<li>Callbacks方法：<code>$.Callbacks(&#39;once memory unique stopOnFalse&#39;);</code></li>
<li>add方法：同时添加多个方法，<code>cb.add(fn1, fn2);</code>、<code>cb.add([fn1, fn2]);</code></li>
</ul>
<p>5、<code>firing</code>参数作用</p>
<ul>
<li>当fire()方法在回调方法里执行时，可能会出现死循环的情况</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function aaa() &#123;</span><br><span class="line">    alert(&apos;1&apos;);</span><br><span class="line">    cb.fire();  // 如果不做处理就会变成持续执行aaa()的死循环</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function bbb() &#123;</span><br><span class="line">    alert(&apos;2&apos;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cb.fire();</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3043-3183-Deferred-延迟对象，对异步操作的统一管理"><a href="#3043-3183-Deferred-延迟对象，对异步操作的统一管理" class="headerlink" title="(3043, 3183) Deferred : 延迟对象，对异步操作的统一管理"></a>(3043, 3183) Deferred : 延迟对象，对异步操作的统一管理</h3><p>1、功能</p>
<ul>
<li>延迟对象是基于<code>$.Callbacks</code>对象</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jQuery.extend(&#123;</span><br><span class="line">    Deferred: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">    when: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;   <span class="comment">// Deferred的辅助</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>2、<code>$.Callbacks</code>与<code>$.Deferred</code>的对比</p>
<table>
<thead>
<tr>
<th style="text-align:center">Callbacks</th>
<th style="text-align:center">dtd.done</th>
<th style="text-align:center">dtd.fail</th>
<th style="text-align:center">dtd.notify</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">add()</td>
<td style="text-align:center">done()</td>
<td style="text-align:center">fail()</td>
<td style="text-align:center">progress</td>
</tr>
<tr>
<td style="text-align:center">fire()</td>
<td style="text-align:center">resolve()</td>
<td style="text-align:center">reject()</td>
<td style="text-align:center">/</td>
</tr>
</tbody>
</table>
<p>3、memory的作用</p>
<ul>
<li>当状态已经完成时，即<code>dtd.resolve()</code>执行后，后面执行到<code>dtd.done()</code>语句时，由该语句绑定的回调都会立即触发</li>
</ul>
<p>4、promise和deferred对象区别</p>
<p>（1）promise的实际属性和方法</p>
<ul>
<li>字面量方法<ul>
<li>state()</li>
<li>always</li>
<li>then()</li>
<li>promise()</li>
</ul>
</li>
<li>赋值方法<ul>
<li>pipe(): <code>promise.pipe = promise.then</code></li>
</ul>
</li>
<li>循环赋值方法<ul>
<li>done()</li>
<li>fail()</li>
<li>progress()</li>
</ul>
</li>
</ul>
<p>（2）deferredd的实际属性和方法</p>
<ul>
<li>字面量方法<ul>
<li>空</li>
</ul>
</li>
<li>循环赋值方法<ul>
<li>resolve()</li>
<li>reject()</li>
<li>notify()</li>
</ul>
</li>
<li>浅拷贝方法<ul>
<li><code>promise.promise( deferred )</code></li>
<li>获得promise所有实际的属性和方法</li>
</ul>
</li>
</ul>
<p>（3）区别</p>
<ul>
<li>promise对象不允许外部代码修改延迟状态</li>
<li>原因就是promise对象比deferred对象少三个方法（resolve、reject和notify)</li>
</ul>
<p>5、when</p>
<ul>
<li>使用方法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function fn1() &#123;</span><br><span class="line">    var dtd = $.Deferred();</span><br><span class="line">    dtd.resolve();</span><br><span class="line">    return dtd;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function fn2() &#123;</span><br><span class="line">    var dtd = $.Deferred();</span><br><span class="line">    dtd.reject();</span><br><span class="line">    return dtd;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$.when(fn1(), 111, fn2(), 222)</span><br><span class="line">    .done(function() &#123;...&#125;)  // 只有当fn1和fn2都成功，才会执行这个done</span><br><span class="line">    .fail(function() &#123;...&#125;); // fn1和fn2中任意一个失败，就会执行fail</span><br></pre></td></tr></table></figure>
<ul>
<li>原理<ul>
<li>单个defer对象参数时<ul>
<li>直接使用这个defer对象</li>
</ul>
</li>
<li>多个defer对象参数时<ul>
<li>新建一个defer对象和一个统计defer对象数的计数器</li>
<li>每一个defer成功后，计数器自减1</li>
<li>defer计数器为0时，执行when的done</li>
<li>任何一个defer失败，都会去执行when的reject</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3184-3295-Support-功能检测，如判断新老版本浏览器"><a href="#3184-3295-Support-功能检测，如判断新老版本浏览器" class="headerlink" title="(3184, 3295) Support : 功能检测，如判断新老版本浏览器"></a>(3184, 3295) Support : 功能检测，如判断新老版本浏览器</h3><p>1、功能</p>
<ul>
<li>通过创建一些元素，判断元素的兼容性来得出浏览器的兼容性</li>
<li>在support中检测差异，在hooks中处理兼容性差异</li>
</ul>
<p>2、checkbox的value默认值</p>
<ul>
<li>老版本webkit的checkbox的默认value值为’’，其他为’on’</li>
</ul>
<hr>
<h3 id="3308-3652-data-data方法实现，数据缓存"><a href="#3308-3652-data-data方法实现，数据缓存" class="headerlink" title="(3308, 3652) data() : data方法实现，数据缓存"></a>(3308, 3652) data() : data方法实现，数据缓存</h3><p>1、attr、prop和data区别</p>
<ul>
<li>attr<ul>
<li>使用原生的<code>setAttribute</code>和<code>getAttribute</code>实现</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&apos;div1&apos;).setAttribute(&apos;name&apos;, &apos;hello&apos;)</span><br><span class="line">document.getElementById(&apos;div1&apos;).getAttribute(&apos;name&apos;)</span><br></pre></td></tr></table></figure>
<ul>
<li>prop<ul>
<li>直接设置DOM对象的属性</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&apos;div1&apos;)[&apos;name&apos;] = &apos;hello&apos;</span><br><span class="line">console.log(document.getElementById(&apos;div1&apos;)[&apos;name&apos;])</span><br></pre></td></tr></table></figure>
<ul>
<li><p>data</p>
<ul>
<li>可防止设置的对象和DOM对象相互引用导致内存泄露</li>
</ul>
</li>
<li><p>区别</p>
<ul>
<li>attr和prop不适合设置大量数据，比较适合设置元素本身的数据，如类class、样式style等</li>
<li>data适合设置大量数据，可以防止内存泄露的问题（DOM元素与对象之间相互引用，大部分浏览器会出现内存泄露）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 相互引用导致内存泄露</span><br><span class="line">var dom = document.getElementById(&apos;div1&apos;);</span><br><span class="line">var obj = &#123;&#125;;</span><br><span class="line">dom.name = obj;</span><br><span class="line">obj.age = dom;</span><br><span class="line"></span><br><span class="line">// 当挂载对象时，obj在其他地方可能引用o，那么就会内存泄露</span><br><span class="line">var o = $(&apos;#div&apos;).attr(&apos;name&apos;, obj)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>2、原理</p>
<ul>
<li>找一个中介cache来连接DOM元素和对象</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$(&apos;#div1&apos;).data(&apos;name&apos;, obj);  // 执行后在元素上生成xxx为1的唯一标识</span><br><span class="line">&lt;div id=&quot;div1&quot; xxx=&quot;1&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">$(&apos;#div2&apos;).data(&apos;age&apos;, obj)</span><br><span class="line">&lt;div id=&quot;div2&quot; xxx=&quot;2&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var cache = &#123;</span><br><span class="line">    &apos;1&apos;: &#123;  // 相当于DOM元素上的属性值永远都是字符串或数字，不会是对象，于是就不会出现内存泄露问题</span><br><span class="line">        name: obj</span><br><span class="line">    &#125;,</span><br><span class="line">    &apos;2&apos;: &#123;</span><br><span class="line">        age: obj</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、</p>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/Javascript/">Javascript</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/jquery/">jquery</a>
  </div>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>

  
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:chenjiefly.github.io">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/2016/06/27/jquery/">jquery源码分析</a>
      </li>
    
      <li>
        <a href="/2016/06/27/html/">HTML相关知识</a>
      </li>
    
      <li>
        <a href="/2016/06/23/css/">CSS知识小记</a>
      </li>
    
      <li>
        <a href="/2016/06/23/jsPerformance/">Javascript 性能分析和提升技巧</a>
      </li>
    
      <li>
        <a href="/2016/06/22/chromeExtension/">chrome 浏览器常用扩展应用</a>
      </li>
    
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/CSS/">CSS</a><small>1</small></li>
  
    <li><a href="/categories/Javascript/">Javascript</a><small>7</small></li>
  
    <li><a href="/categories/博客/">博客</a><small>1</small></li>
  
    <li><a href="/categories/基础知识/">基础知识</a><small>1</small></li>
  
    <li><a href="/categories/工具/">工具</a><small>4</small></li>
  
    <li><a href="/categories/技术/">技术</a><small>2</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/CSS/">CSS</a><small>1</small></li>
  
    <li><a href="/tags/Canvas/">Canvas</a><small>1</small></li>
  
    <li><a href="/tags/HTML/">HTML</a><small>1</small></li>
  
    <li><a href="/tags/JS性能/">JS性能</a><small>1</small></li>
  
    <li><a href="/tags/chrome/">chrome</a><small>1</small></li>
  
    <li><a href="/tags/debug/">debug</a><small>1</small></li>
  
    <li><a href="/tags/fresh/">fresh</a><small>1</small></li>
  
    <li><a href="/tags/git/">git</a><small>1</small></li>
  
    <li><a href="/tags/gitbook/">gitbook</a><small>1</small></li>
  
    <li><a href="/tags/hexo/">hexo</a><small>1</small></li>
  
    <li><a href="/tags/jquery/">jquery</a><small>1</small></li>
  
    <li><a href="/tags/network/">network</a><small>1</small></li>
  
    <li><a href="/tags/react/">react</a><small>1</small></li>
  
    <li><a href="/tags/regExp/">regExp</a><small>1</small></li>
  
    <li><a href="/tags/software/">software</a><small>1</small></li>
  
    <li><a href="/tags/threejs/">threejs</a><small>1</small></li>
  
    <li><a href="/tags/tools/">tools</a><small>1</small></li>
  
    <li><a href="/tags/提效/">提效</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 chenjiefly
  
  
</div>
<div class="clearfix"></div></footer>
  <script src="//libs.baidu.com/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'chenjiefly';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



</body>
</html>